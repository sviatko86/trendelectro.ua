<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trend Electro — Каталог</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.3.2/papaparse.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;700;900&display=swap');
        body { font-family: 'Inter', sans-serif; scroll-behavior: smooth; }
        .category-pill.active { background-color: #facc15; color: black; border-color: #facc15; }
    </style>
</head>
<body class="bg-slate-900 text-white pb-32">

<header class="bg-slate-800/90 backdrop-blur-md border-b border-slate-700 sticky top-0 z-50 p-4">
    <div class="container mx-auto flex flex-col gap-4">
        <div class="flex justify-between items-center">
            <div class="flex items-center gap-3 cursor-pointer" onclick="location.reload()">
                <div class="bg-yellow-400 p-2 rounded-xl text-black shadow-[0_0_15px_rgba(250,204,21,0.5)]"><i class="fas fa-bolt"></i></div>
                <h1 class="text-2xl font-black uppercase italic tracking-tighter">Trend <span class="text-yellow-500">Electro</span></h1>
            </div>
            <div class="flex gap-2">
                <button onclick="openWheel()" class="bg-slate-700 p-3 rounded-2xl text-yellow-400"><i class="fas fa-gift"></i></button>
                <div id="cartBtn" class="bg-yellow-400 text-black px-6 py-3 rounded-2xl flex items-center gap-3 font-black cursor-pointer shadow-lg shadow-yellow-400/20">
                    <i class="fas fa-shopping-bag"></i> <span id="cartCount">0</span>
                </div>
            </div>
        </div>
        
        <div class="relative">
            <input type="text" id="searchInput" oninput="render()" placeholder="Шукати серед 3000 товарів..." class="w-full bg-slate-700/50 border border-slate-600 rounded-2xl py-4 px-6 outline-none focus:ring-2 focus:ring-yellow-400 text-white font-bold transition-all">
        </div>

        <div id="categoryList" class="flex gap-2 overflow-x-auto pb-2 no-scrollbar">
            <button onclick="setCategory('all')" class="category-pill active px-5 py-2 rounded-full border border-slate-600 whitespace-nowrap text-sm font-bold transition-all">Всі товари</button>
            <button onclick="setCategory('освітлення')" class="category-pill px-5 py-2 rounded-full border border-slate-600 whitespace-nowrap text-sm font-bold transition-all">Освітлення</button>
            <button onclick="setCategory('кабель')" class="category-pill px-5 py-2 rounded-full border border-slate-600 whitespace-nowrap text-sm font-bold transition-all">Кабель та Провід</button>
            <button onclick="setCategory('розетки')" class="category-pill px-5 py-2 rounded-full border border-slate-600 whitespace-nowrap text-sm font-bold transition-all">Розетки та Вимикачі</button>
            <button onclick="setCategory('автомати')" class="category-pill px-5 py-2 rounded-full border border-slate-600 whitespace-nowrap text-sm font-bold transition-all">Автоматика</button>
            <button onclick="setCategory('інструмент')" class="category-pill px-5 py-2 rounded-full border border-slate-600 whitespace-nowrap text-sm font-bold transition-all">Інструмент</button>
            <button onclick="setCategory('тепла підлога')" class="category-pill px-5 py-2 rounded-full border border-slate-600 whitespace-nowrap text-sm font-bold transition-all">Тепла підлога</button>
        </div>
    </div>
</header>

<main class="container mx-auto px-4 py-8">
    <div id="loader" class="text-center py-20 font-black text-slate-500 animate-pulse text-2xl uppercase italic">Синхронізація категорій...</div>
    <div id="grid" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-6"></div>
</main>

<div id="orderBar" class="fixed bottom-0 left-0 right-0 bg-white p-6 shadow-2xl transform translate-y-full transition-all duration-500 z-50 rounded-t-[2.5rem] text-slate-900">
    <div class="container mx-auto flex justify-between items-center">
        <div>
            <p class="text-[10px] font-black uppercase text-slate-400">Сума замовлення:</p>
            <span id="finalSum" class="text-3xl font-black italic">0 грн</span>
        </div>
        <button onclick="sendOrder()" class="bg-blue-600 hover:bg-blue-500 text-white px-10 py-4 rounded-2xl font-black flex items-center gap-3 shadow-xl">
            <i class="fab fa-telegram-plane"></i> ЗАМОВИТИ
        </button>
    </div>
</div>

<script>
    const MARKUP = 1.5;
    let products = [];
    let cart = {};
    let currentCategory = 'all';

    function loadData() {
        Papa.parse('data.csv', {
            download: true, header: false, skipEmptyLines: true,
            complete: function(results) {
                products = results.data.map((row, index) => {
                    const line = row.join(' ').trim();
                    const parts = line.split(/\t| {2,}/).filter(x => x.trim() !== "");
                    if (parts.length < 2) return null;
                    const rawPrice = parts[parts.length - 1].replace(',', '.');
                    const basePrice = parseFloat(rawPrice) || 0;
                    return { 
                        id: index, 
                        sku: parts[0], 
                        name: parts.slice(1, -1).join(' '), 
                        price: Math.round(basePrice * MARKUP) 
                    };
                }).filter(p => p !== null);
                document.getElementById('loader').classList.add('hidden');
                render();
            }
        });
    }

    function setCategory(cat) {
        currentCategory = cat;
        document.querySelectorAll('.category-pill').forEach(btn => {
            btn.classList.remove('active');
            if(btn.innerText.toLowerCase() === cat || (cat === 'all' && btn.innerText === 'Всі товари')) btn.classList.add('active');
        });
        render();
    }

    function render() {
        const query = document.getElementById('searchInput').value.toLowerCase();
        const grid = document.getElementById('grid');
        
        let filtered = products.filter(p => p.name.toLowerCase().includes(query) || p.sku.toLowerCase().includes(query));
        
        if (currentCategory !== 'all') {
            filtered = filtered.filter(p => p.name.toLowerCase().includes(currentCategory.split(' ')[0]));
        }

        grid.innerHTML = filtered.slice(0, 300).map(p => `
            <div class="bg-slate-800 p-6 rounded-[2rem] border border-slate-700 hover:border-yellow-400 transition-all flex flex-col justify-between group">
                <div>
                    <span class="text-[10px] font-black text-slate-500 uppercase tracking-widest block mb-2">${p.sku}</s
