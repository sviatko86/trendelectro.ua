<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trend Electro ‚Äî Premium Shop</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <style>
        :root { --main-bg: #0f172a; --card-bg: #1e293b; --accent: #eab308; }
        body { background-color: var(--main-bg); color: white; font-family: 'Inter', sans-serif; }
        .product-card { background: var(--card-bg); border-radius: 2rem; border: 1px solid rgba(255,255,255,0.05); transition: 0.3s; height: 100%; display: flex; flex-direction: column; }
        .product-card:hover { transform: translateY(-5px); border-color: var(--accent); }
        .category-btn { background: rgba(255,255,255,0.05); padding: 10px 20px; border-radius: 99px; font-size: 13px; font-weight: 700; white-space: nowrap; }
        .category-btn.active { background: var(--accent); color: #000; }
    </style>
</head>
<body>

    <header class="p-6 sticky top-0 z-40 backdrop-blur-xl bg-[#0f172a]/80 border-b border-white/5">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-2xl font-black uppercase italic">Trend <span class="text-yellow-500">Electro</span></h1>
            <button onclick="toggleCart()" class="relative bg-white/5 w-12 h-12 rounded-2xl flex items-center justify-center">
                <i class="fas fa-shopping-cart"></i>
                <span id="cart-count" class="absolute -top-2 -right-2 bg-red-600 text-white text-[10px] w-6 h-6 flex items-center justify-center rounded-full font-black">0</span>
            </button>
        </div>
    </header>

    <main class="container mx-auto px-4 py-8">
        <input type="text" id="search" placeholder="–ü–æ—à—É–∫ –∑–∞ –Ω–∞–∑–≤–æ—é –∞–±–æ –∞—Ä—Ç–∏–∫—É–ª–æ–º..." 
            class="w-full p-6 rounded-3xl bg-white/5 border border-white/10 mb-8 outline-none focus:border-yellow-500 text-white">

        <div class="flex gap-3 overflow-x-auto pb-8 no-scrollbar" id="filters">
            <button onclick="filterCat('all', this)" class="category-btn active">‚ö°Ô∏è –í–°–ï</button>
            <button onclick="filterCat('–û—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è', this)" class="category-btn">üí° –°–í–Ü–¢–õ–û</button>
            <button onclick="filterCat('–ö–∞–±–µ–ª—å', this)" class="category-btn">üîå –ö–ê–ë–ï–õ–¨</button>
            <button onclick="filterCat('–†–æ–∑–µ—Ç–∫–∏', this)" class="category-btn">üîò –†–û–ó–ï–¢–ö–ò</button>
            <button onclick="filterCat('–ê–≤—Ç–æ–º–∞—Ç–∏–∫–∞', this)" class="category-btn">üõ° –ê–í–¢–û–ú–ê–¢–ò–ö–ê</button>
        </div>

        <div id="status-msg" class="text-center py-10 text-yellow-500 font-bold hidden"></div>
        <div id="product-list" class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6"></div>
    </main>

    <script>
        let products = [];
        let cart = {};
        let currentCat = 'all';

        // –§—É–Ω–∫—Ü—ñ—è –¥–ª—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ–≥–æ —á–∏—Ç–∞–Ω–Ω—è CSV
        function parseCSV(text) {
            const rows = [];
            let row = [''];
            let inQuotes = false;
            for (let i = 0; i < text.length; i++) {
                const char = text[i];
                if (char === '"') inQuotes = !inQuotes;
                else if (char === ',' && !inQuotes) row.push('');
                else if (char === '\r' || char === '\n') {
                    if (!inQuotes) {
                        if (row.length > 1) rows.push(row);
                        row = [''];
                    }
                } else row[row.length - 1] += char;
            }
            return rows;
        }

        async function init() {
            const status = document.getElementById('status-msg');
            try {
                // –í–ê–ñ–õ–ò–í–û: –ü–µ—Ä–µ–∫–æ–Ω–∞–π—Å—è, —â–æ —Ñ–∞–π–ª –Ω–∞–∑–∏–≤–∞—î—Ç—å—Å—è —Å–∞–º–µ data.csv
                const res = await fetch('data.csv');
                if (!res.ok) throw new Error("–§–∞–π–ª data.csv –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ!");
                
                const text = await res.text();
                const rows = parseCSV(text);
                
                // –ü—Ä–æ–ø—É—Å–∫–∞—î–º–æ –∑–∞–≥–æ–ª–æ–≤–æ–∫ (rows[0])
                products = rows.slice(1).map(row => {
                    const sku = row[0]?.trim();
                    const name = row[1]?.trim();
                    const img = row[3]?.trim();
                    if (!sku || !name) return null;

                    return {
                        sku, name, 
                        image: (img && img.includes('http')) ? img : null,
                        price: 150, // –°—Ç–∞–≤–∏–º–æ —Ü—ñ–Ω—É –∑–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º
                        cat: detectCat(name)
                    };
                }).filter(p => p !== null);

                if (products.length === 0) {
                    status.innerText = "–¢–æ–≤–∞—Ä–∏ –≤ –±–∞–∑—ñ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω—ñ (–ø–µ—Ä–µ–≤—ñ—Ä —Å—Ç—Ä—É–∫—Ç—É—Ä—É CSV)";
                    status.classList.remove('hidden');
                }

                render();
            } catch (e) {
                status.innerText = "–ü–æ–º–∏–ª–∫–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è: " + e.message;
                status.classList.remove('hidden');
                console.error(e);
            }
        }

        function detectCat(name) {
            const n = name.toLowerCase();
            if (n.includes('–ª–∞–º–ø–∞') || n.includes('led')) return '–û—Å–≤—ñ—Ç–ª–µ–Ω–Ω—è';
            if (n.includes('–∫–∞–±–µ–ª') || n.includes('–ø—Ä–æ–≤—ñ–¥')) return '–ö–∞–±–µ–ª—å';
            if (n.includes('—Ä–æ–∑–µ—Ç–∫') || n.includes('–≤–∏–º–∏–∫')) return '–†–æ–∑–µ—Ç–∫–∏';
            if (n.includes('–∞–≤—Ç–æ–º–∞—Ç') || n.includes('—â–∏—Ç')) return '–ê–≤—Ç–æ–º–∞—Ç–∏–∫–∞';
            return '–Ü–Ω—à–µ';
        }

        function render() {
            const list = document.getElementById('product-list');
            const term = document.getElementById('search').value.toLowerCase();
            
            const filtered = products.filter(p => 
                (p.name.toLowerCase().includes(term) || p.sku.toLowerCase().includes(term)) &&
                (currentCat === 'all' || p.cat === currentCat)
            );

            list.innerHTML = filtered.map(p => `
                <div class="product-card p-4">
                    <div class="bg-white rounded-2xl h-48 mb-4 overflow-hidden flex items-center justify-center p-2">
                        <img src="${p.image || 'https://via.placeholder.com/200?text=Trend+Electro'}" class="max-h-full object-contain">
                    </div>
                    <div class="flex-grow">
                        <p class="text-[10px] text-yellow-500 font-bold mb-1 uppercase">${p.sku}</p>
                        <h3 class="font-bold text-sm leading-tight line-clamp-2 mb-4">${p.name}</h3>
                    </div>
                    <div class="flex justify-between items-center mt-auto bg-black/20 p-2 rounded-xl">
                        <span class="font-black text-yellow-500">${p.price} –≥—Ä–Ω</span>
                        <button onclick="addToCart('${p.sku}')" class="bg-yellow-500 text-black w-10 h-10 rounded-lg flex items-center justify-center font-bold">+</button>
                    </div>
                </div>
            `).join('');
        }

        function addToCart(sku) {
            cart[sku] = (cart[sku] || 0) + 1;
            document.getElementById('cart-count').innerText = Object.values(cart).reduce((a, b) => a + b, 0);
            alert("–î–æ–¥–∞–Ω–æ!");
        }

        function filterCat(cat, btn) {
            currentCat = cat;
            document.querySelectorAll('.category-btn').forEach(b => b.classList.remove('active'));
            btn.classList.add('active');
            render();
        }

        document.getElementById('search').oninput = render;
        window.onload = init;
    </script>
</body>
</html>
